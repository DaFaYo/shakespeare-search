<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Shakespeare Search</title>
    <link rel="stylesheet" href="/css/style.css">
    <script>
        async function doSearch(event) {
            event.preventDefault();

            const query = document.querySelector('#query').value;
            const fuzzy = document.querySelector('#fuzzy').checked;
            const exact = document.querySelector('#exact').checked;

            const resultsContainer = document.querySelector('#results');
            resultsContainer.innerHTML = '<p>Loading...</p>';

            try {
                const response = await fetch(`/api/search?q=${encodeURIComponent(query)}&fuzzy=${fuzzy}&exact=${exact}`);
                const results = await response.json();

                if (results.length === 0) {
                    resultsContainer.innerHTML = '<p>Geen resultaten gevonden.</p>';
                    return;
                }

                resultsContainer.innerHTML = results.map(r => `
                    <div class="result">
                        <h2>${r.title}</h2>
                        <p><strong>Aantal voorkomens:</strong> ${r.occurrences}</p>
                        <p>${r.highlightedText}</p>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Search failed:', error);
                resultsContainer.innerHTML = '<p>Er is een fout opgetreden tijdens het zoeken.</p>';
            }
        }
    </script>
</head>
<body>
<header>
    <h1>Shakespeare Search</h1>
</header>

<main>
    <form id="searchForm" onsubmit="doSearch(event)">
        <input type="text" id="query" placeholder="Enter keyword..." />
        <label>
            <input type="checkbox" id="fuzzy" /> Fuzzy search
        </label>
        <label>
            <input type="checkbox" id="exact" /> Exact phrase
        </label>
        <button type="submit">Search</button>
    </form>

    <div id="results"></div>
</main>

<footer>
    <p>Demo app - Shakespeare Search with Elasticsearch</p>
</footer>
</body>
</html>
